{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nexport default async function getImagesByQuery(query, page = 1) {\n  try {\n    const response = await axios.get('', {\n      params: {\n        per_page: 15,\n        page: page,\n        key: '50399513-0102622743a29b0122ce40bab',\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    console.error('API Error:', error);\n    throw error;\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst galleryList = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.loadMoreBtn');\n\nconst galleryLib = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function createGallery(images) {\n  const markup = images\n    .map(image => {\n      const keysToShow = ['likes', 'views', 'comments', 'downloads'];\n      const infoMarkup = keysToShow\n        .map(\n          key =>\n            `<p class=\"info-item\">${capitalizeFirstLetter(\n              key\n            )}:<span class=\"info\">${image[key]}</span></p>`\n        )\n        .join('');\n      return `<li class=\"image-item\">\n    <a href=\"${image.largeImageURL}\" title=\"${image.tags}\">\n    <img src=\"${image.webformatURL}\" \n    alt=\"${image.tags}\"\n    />\n    </a>\n    <div class=\"gallery-info\">\n    ${infoMarkup}\n    </div>\n    </li>`;\n    })\n    .join('');\n  galleryList.insertAdjacentHTML('beforeend', markup);\n  galleryLib.refresh();\n}\n\nfunction capitalizeFirstLetter(string) {\n  if (!string) {\n    return string;\n  }\n  return string.charAt(0).toUpperCase() + string.slice(1).toLowerCase();\n}\nexport function clearGallery() {\n  galleryList.innerHTML = '';\n}\nexport function showLoader() {\n  if (loader) {\n    loader.style.display = 'inline-block';\n  }\n}\nexport function hideLoader() {\n  if (loader) {\n    loader.style.display = 'none';\n  }\n}\nexport function showLoadMoreButton() {\n  if (loadMoreBtn) {\n    loadMoreBtn.style.display = 'inline-block';\n  }\n}\nexport function hideLoadMoreButton() {\n  if (loadMoreBtn) {\n    loadMoreBtn.style.display = 'none';\n  }\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport getImagesByQuery from './js/pixabay-api';\nimport {\n  clearGallery,\n  createGallery,\n  showLoader,\n  hideLoader,\n  hideLoadMoreButton,\n  showLoadMoreButton,\n} from './js/render-functions';\n\nconst formData = document.querySelector('.form');\nconst inputSearch = document.querySelector('input[name=\"search-text\"]');\nconst btnSubmit = document.querySelector('button[type=\"submit\"]');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.loadMoreBtn');\nconst perPage = 15;\n\nlet totalHits = 0;\nlet currentPage = 1;\nlet currentQuery = '';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  validateInput();\n  hideLoadMoreButton();\n  hideLoader();\n});\n\ninputSearch.addEventListener('input', validateInput);\n\nformData.addEventListener('submit', async ev => {\n  ev.preventDefault();\n\n  const searchQuery = inputSearch.value.trim();\n\n  if (searchQuery !== currentQuery) {\n    currentPage = 1;\n    totalHits = 0;\n    clearGallery();\n    hideLoadMoreButton();\n  }\n  currentQuery = searchQuery;\n\n  if (!validateInput()) {\n    iziToast.error({\n      title: 'Поле не може бути порожнім',\n      message: 'Будь ласка, введіть текст для пошуку.',\n      position: 'topRight',\n    });\n    hideLoadMoreButton();\n    return;\n  }\n\n  showLoader();\n\n  try {\n    const responseData = await getImagesByQuery(currentQuery, currentPage);\n    const images = responseData.hits;\n    totalHits = responseData.totalHits;\n\n    if (images.length === 0) {\n      iziToast.info({\n        title: 'Відхилено',\n        message: 'За Вашим запитом зображень не знайдено.',\n        position: 'topRight',\n      });\n      hideLoadMoreButton();\n    } else {\n      createGallery(images);\n      updateLoadMoreButtonState();\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Помилка',\n      message:\n        'Під час завантаження зображень сталася помилка. Спробуйте ще раз.',\n      position: 'topRight',\n    });\n    clearGallery();\n    hideLoadMoreButton();\n  } finally {\n    hideLoader();\n    validateInput();\n  }\n});\n\nfunction validateInput() {\n  if (inputSearch.value.trim() !== '') {\n    btnSubmit.disabled = false;\n    return true;\n  } else {\n    btnSubmit.disabled = true;\n    return false;\n  }\n}\n\nloadMoreBtn.addEventListener('click', async () => {\n  currentPage++;\n  showLoader();\n  hideLoadMoreButton();\n\n  try {\n    const responseData = await getImagesByQuery(currentQuery, currentPage);\n    const images = responseData.hits;\n\n    createGallery(images);\n    updateLoadMoreButtonState();\n    smoothScrollToGallery();\n  } catch (error) {\n    iziToast.error({\n      title: 'Помилка',\n      message:\n        'Під час завантаження додаткових зображень сталася помилка. Спробуйте ще раз.',\n      position: 'topRight',\n    });\n    hideLoadMoreButton();\n  } finally {\n    hideLoader();\n  }\n});\n\nfunction updateLoadMoreButtonState() {\n  const totalPages = Math.ceil(totalHits / perPage);\n\n  if (currentPage >= totalPages || totalHits === 0) {\n    hideLoadMoreButton();\n\n    if (totalHits > 0) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'bottomCenter',\n      });\n    }\n  } else {\n    showLoadMoreButton();\n  }\n}\n\nfunction smoothScrollToGallery() {\n  const galleryCard = gallery.firstElementChild;\n\n  if (galleryCard) {\n    const cardRect = galleryCard.getBoundingClientRect();\n    const cardHeight = cardRect.height;\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n}\n"],"names":["axios","getImagesByQuery","query","page","error","galleryList","loader","loadMoreBtn","galleryLib","SimpleLightbox","createGallery","images","markup","image","infoMarkup","key","capitalizeFirstLetter","string","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","formData","inputSearch","btnSubmit","gallery","perPage","totalHits","currentPage","currentQuery","validateInput","ev","searchQuery","iziToast","responseData","updateLoadMoreButtonState","smoothScrollToGallery","totalPages","galleryCard","cardHeight"],"mappings":"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"}